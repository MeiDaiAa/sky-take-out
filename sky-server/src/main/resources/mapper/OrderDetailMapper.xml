<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sky.mapper.OrderDetailMapper">
    <insert id="insertBatch">
        insert into order_detail (order_id, dish_id, setmeal_id, name, dish_flavor, number, amount, image) values
        <foreach item="orderDetail" collection="orderDetailList" separator=",">
            (#{orderDetail.orderId}, #{orderDetail.dishId}, #{orderDetail.setmealId}, #{orderDetail.name}, #{orderDetail.dishFlavor}, #{orderDetail.number}, #{orderDetail.amount}, #{orderDetail.image})
        </foreach>
    </insert>
    <select id="getDishesSalesTop10ByDates" resultType="com.sky.dto.GoodsSalesDTO">
        select order_detail.name, sum(order_detail.number) as number
        from order_detail
        left join orders on order_detail.order_id = orders.id
        <where>
            <if test="begin != null">and orders.order_time &gt;= #{begin}</if>
            <if test="end != null">and orders.order_time &lt;= #{end}</if>
            <if test="status != null">and orders.status = #{status}</if>
        </where>
        group by name
        order by number desc
        limit 10
    </select>
</mapper>
